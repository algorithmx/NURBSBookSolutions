# Q01.14

## Question

For given $n$, row vector $[B_{0,n}(u), B_{1,n}(u), \cdots,  B_{n,n}(u)]$ can be written as $[1,u,u^2,\cdots,u^n]M$, where $M$ is an $(n+1)\times(n+1)$ matrix. Thus, a Bézier curve can be written in matrix form, $\mathbf{C}(u)=[u^i]^T M[\mathbf{P}_i]$. Compute the matrix $M$ for $n=1,2,3$. Notice that setting $[\mathbf{a}_i]=M[\mathbf{P}_i]$ yields the conversion of a Bézier curve to power basis form. Assuming $0 \le u \le 1$, $[\mathbf{P}_i]=M^{-1}[\mathbf{a}_i]$ gives the conversion from power basis to Bézier form.

## Solution

According to the definition of Bernstein basis function in Eq.(1.8), we have 

$B_{i,n}(u) = \binom{n}{i} u^i (1-u)^{n-i}$.

The coefficient on $u^k$ in $B_{i,n}(u)$ is denoted as ${\cal C}_{i,n}^k$. It has the following form:

${\cal C}_{i,n}^{k}=\begin{cases}
\binom{n}{i}\binom{n-i}{k-i}(-1)^{k-i} & k\ge i\\
0 & k<i
\end{cases}$

Therefore we have the following form of matrix element $m_{ij}$ for $M$:

$m_{ki} = {\cal C}_{i,n}^{k}$.

The full matrix is 

$M_n = \begin{bmatrix}{\cal C}_{0,n}^{0} & {\cal C}_{1,n}^{0} & {\cal C}_{2,n}^{0} & \cdots & {\cal C}_{n,n}^{0}\\
{\cal C}_{0,n}^{1} & {\cal C}_{1,n}^{1} & {\cal C}_{2,n}^{1} & \cdots & {\cal C}_{n,n}^{1}\\
{\cal C}_{0,n}^{2} & {\cal C}_{1,n}^{2} & {\cal C}_{2,n}^{2} & \cdots & {\cal C}_{n,n}^{2}\\
\vdots &  &  & \ddots & \vdots\\
{\cal C}_{0,n}^{n} & {\cal C}_{1,n}^{n} & {\cal C}_{2,n}^{n} & \cdots & {\cal C}_{n,n}^{n}
\end{bmatrix}$

Since we have $m_{ki} = 0$ for $k<i$, the above matrix is a lower triangular matrix.

Let us write down the first few matrices. For $n=1$ we have

$M_1 = \begin{bmatrix}1 & 0\\
-1 & 1
\end{bmatrix}$

$M_2 = \begin{bmatrix}1 & 0 & 0\\
-2 & 2 & 0\\
1 & -2 & 1
\end{bmatrix}$

$M_3 = \begin{bmatrix}1 & 0 & 0 & 0\\
-3 & 3 & 0 & 0\\
3 & -6 & 3 & 0\\
-1 & 3 & -3 & 1
\end{bmatrix}$

## Code

The matrix element is computed by the following Julia code.

```julia
C(k,i,n) = (-1)^(k-i) * binomial(n,i) * binomial(n-i,k-i)
M(n) = [C(k,i,n) for k=0:n, i=0:n]
```

